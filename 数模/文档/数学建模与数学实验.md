#数学建模与数学实验（第4版）
@(舰长同学)

##第5章 网络优化
#### ###5.2.1 基本概念
#### 5.2.2固定起点的最短路
*  Dijkstra算法：求G中从顶点u0到其余顶点的最短路.

#### 5.2.3每对顶点之间的最短路
*  Floyd算法：求任意两点间的最短路.

### 5.7 最小生成树问题
#### 5.7.1 Kruskal算法
#### 5.7.2 Prim算法

## 第6章 微分方程与差分方程
### 6.3用MATLAB解微分方程
#### 6.3.1 微分方程（组）的解析解
	dsolve('函数表达式','自变量')
	dsolve('函数表达式','初值条件','自变量')

#### 6.3.2 微分方程(组)的数值解
	[t,x] = solver('f',ts,x0,options)

> solver取函数ode45，ode23,ode113,ode15s,ode23s中的一个，不同的函数代表不同的内部算法.f是由待解方程写成的M文件名；ts=[t0,tf],t0,tf为自变量的初值和终值;x0为函数的初值；options用于限定误差限（缺省时设定为相对误差10^(-3),绝对误差为10^(-6)

	options=odeset('reltol',rt,'abstol',at)
> 这里的rt,at分别为设定的相对误差和绝对误差

### 6.4差分方程模型及解法

##第7章 插值与拟合

### 7.2 用MATLAB解插值问题
#### 7.2.1一维插值
	interp1(x，y，xi，'method')
x，y分别表示数据点的横、纵坐标，所有的插值方法都要求x是单调的，并且xi不能够超过x的范围。method为可选参数，可从以下四个值中任选一个

* ‘nearest’ ：最邻近插值
* ‘linear’ ： 线性插值；
* ‘spline’ ： 三次样条插值；
* ‘cubic’ ： 立方插值(三次插值)
* ‘linear’ 是缺省值，当缺省时按(分段)线性插值处理 

#### 7.2.2 二维插值
*  插值基点为网络结点

```
cz=interp2(x,y,z,cx,cy,’method’)
```
cz为被插值点的函数值 （x,y,z）为插值节点 其中x,y为自变量 z为相应的函数值
要求x,y是单调递增的；cx，cy可取为矩阵，或cx取行向量，cy取为列向量，cx,cy的值分别不能超出x,y的范围。method为可选参数,标准同interp1()

 * 插值基点为散乱结点

```	
cz =griddata（x，y，z，cx，cy，‘method’） 
```

Method为可选参数，从以下四值中任选一个

* 'nearest'   最邻近插值
* 'linear'   双线性插值
* 'cubic'    双三次插值
* 'v4'- Matlab提供的插值方法
*  缺省时,  双线性插值'linear'

Matlab还提供了基于修正的Shepherd插值法的函数，e01set 和 e01sff,这两个函数必须同时使用.首先使用e01sef求出参数rnw和fnodes,再将他们用于函数e01sff中，求得插值点的坐标.

```	
[fnodes,minnq,rnw,rnq,ifail]=e01sef(x,y,z)
[cz(i,j),ifail]=e01sff(x,y,z,rnw,fnodes,cx(i),cy(j))
```

###7.4用MATLAB解曲线拟合问题
####7.4.1 线性最小二乘拟合
在MATLAB的线性最小二乘拟合中，用得较多的是**多项式拟合**，其命令为：

	A=polyfit(x,y,m)

其中，x=(x1,x2,...,xn),y=(y1,y2,...,yn),A=(a1,a2,...a(m+1)).
多项式在x处的值y可用以下命令计算：
	
	y=polyval(A,x)
#### 7.4.2 非线性最小二乘拟合
MATLAB优化工具箱中提供了两个求非线性最小二乘拟合的函数:lsqcurvefit和lsqnonlin.使用这两个命令时，都要先建立M-文件fun.m,在其中定义函数f(x),但他们定义f(x)方式不同.

* lsqcurvefit

	设已知 \\(\mathbf{xdata}=(xdata_1,xdata_2,...,xdata_n)\\)，\\(\mathbf{ydata}=(ydata_1,ydata_2,...,ydata_n)\\)，lsqcurvefit用以求含参量x（向量）的向量值函数\\(F\mathbf{(x,xdata)}=\left ( F\left ( \mathbf{x},xdata_1 \right ),...,\left ( \mathbf{x},xdata_n\right ) \right )^T\\)中的参变量x(向量),使得\\(\sum _{i=1}^n\left ( \mathbf{F}\left ( \mathbf{x},xdata_i \right )-ydata_i \right )^2\\)最小.

输入格式：
	
1.  x=lsqcurvefit('fun',x0,xdata,ydata);
2.  x=lsqcurvefit('fun',x0,xdata,ydata,options);
3.  x=lsqcurvefit('fun',x0,xdata,ydata,options,'grad');
4.  [x,options]=lsqcurvefit('fun',x0,xdata,ydata,...);
5.  [x,options,funval]=lsqcurvefit('fun',x0,xdata,ydata,...);
6.  [x,options,funval,Jacob]=lsqcurvefit('fun',x0,xdata,ydata,...);

输出目标函数值格式：
f=fun(x,xdata) 其中x0为迭代的初值.

* lsqnonlin
  设已知 \\(\mathbf{xdata}=(xdata_1,xdata_2,...,xdata_n)\\)，\\(\mathbf{ydata}=(ydata_1,ydata_2,...,ydata_n)\\)，lsqnonlin用以求含参量x（向量）的向量值函数\\(f(\mathbf{x})=(f_1(\mathbf{x}),f_2(\mathbf{x}),...,f_n(\mathbf{x}))^T\\)中的参数\\(\mathbf{x}\\)，使得\\(f^T(\mathbf{x})f(x)=f^2_1(\mathbf{x})+f^2_2(\mathbf{x})+...+f^2_n(\mathbf{x})\\)最小，其中\\(f_i(\mathbf{x})=f(\mathbf{x},xdata_i,ydata_i)=\mathbf{F}(x,xdata_i)-ydata_i\\).

输入格式：

1. x=lsqnonlin('fun',x0);
2. x=lsqnonlin('fun',x0,options);
3. x=lsqnonlin('fun',x0,options,'grad');
4. [x,options]=lsqnonlin('fun',x0,...);
5. [x,options,funval]=lsqnonlin('fun',x0,...);

## 第8章 数据的统计描述  
### 8.5 MATLAB数据统计

## 第9章 统计分析
### 9.1.2 MATLAB统计工具箱中的回归分析命令
一、 多元线性回归
	
  多元线性回归的命令是regress，此命令也可用于一元线性回归，其格式如下：

1. 确定回归系数的点估计值，用命令：\\(b=regress(Y,X)\\).
2. 求回归系数的点估计和区间估计，并检验回归模型，用命令：\\([b,bint,r,rint,stats]=regress(Y,X,alpha)\\)
3. 画出残差及其置信区间，用命令：\\(tcoplot(r,rint)\\)
上述命令中，各符号的含义如下：

* （1） \\(\mathbf{X}= \begin{bmatrix}
 1&  x_11&  x_12& ... &x_1k \\ 
 1&  x_21&  x_22& ... &x_2k \\ 
 ...&  ...&  ...& ...&... \\ 
 1&  x_n1&x_n2  &...  &x_nk 
\end{bmatrix}\\),
\\(\mathbf{Y}=\begin{bmatrix}
y_1\\ 
y_2\\ 
...\\ 
y_n
\end{bmatrix}\\),
\\(\mathbf{b} = \begin{bmatrix}
\hat{\beta_0}\\
\hat{\beta_1}\\ 
...\\ 
\hat{\beta_k}
\end{bmatrix}\\)

	   \\(\mathbf{b}\\)为回归系数的点估计值\\(\hat{\beta}\\)，对一元线性回归，取k=1即可
	
* （2）alpha为显著性水平（缺省时为0.05）
* （3）bint为回归系数的区间估计
* （4）r与rint分别为残差及其置信区间
* （5）stats是用于检验回归模型的统计量，有4个数值，第一个是相关系数\\(\mathbf{R}^2\\),\\(\mathbf{R}^2\\)越接近1，说明回归方程越显著；第二个是\\(\mathbf{F}\\)值，\\(\mathbf{F}>\mathbf{F_1-_\alpha}(k,n-k-1)\\)时，拒绝\\(\mathbf{H}_0\\),\\(\mathbf{F}\\)越大，说明回归方程越显著；第三个是与\\(\mathbf{F}\\)对应的概率\\(\mathbf{P}\\)，\\(\mathbf{P}\\)<\\(\mathbf{\alpha}\\)时拒绝\\(\mathbf{H}_0\\)，回归模型成立；第四个是模型方差的估计值\\(\widehat{\sigma}^2=\frac{SSE}{n-2}\\).

二、多项式回归

1. 一元多项式回归
  一元多项式回归可用命令ployfit，polyval,polyconf来实现.
  
  （1）回归：
 * 确定多项式系数的命令：\\([p,S]=polyfit(x,y,m)\\)
  其中，\\(x=(x_1,x_2,...,x_n)\\),\\(y=(y_1,y_2,...,y_n)\\),\\(p=(a_1,a_2,...,a_m+_1)\\)是多项式\\(y=a_1x^m+a_2x^m-^1+...+a_mx+a_m+_1\\)的系数；S是一个矩阵，用来估计预测误差.
 * 一元多项式回归命令：ploytool(x,y,m)
 此命令产生一个交互式的画面，画面中有拟合曲线和y的置信区间.通过左下方的Export下拉式菜单，可以输出回归系数等.
 
 （2）预测和预测误差估计：
 
  * \\(Y=polyval(p,x)\\),求polyfit所得的回归多项式在x处的预测值Y；
  * \\([Y,DELTA]=polyconf(p,x,S,alpha)\\)，求polyfit所得的回归多项式在x处的预测值Y及预测值的显著性为1-alpha的置信区间\\(Y\pm DELTA \\);alpha缺省时为0.05.
  一元多项式回归也可化为多元线性回归来解.
  
  2.多元二项式回归
  
  多元二项式回归用命令：rstool(x,y,'model',alpha).
  
  其中，输出数据x,y分别为n*m矩阵和n维列向量;alpha为显著性水平(缺省时为0.05)；model由下列4个模型中选择1个(用字符串输入，缺省时为线性模型)：
 
 * linear(线性)：\\(y=\beta _0+\beta_1 x_1+...+\beta_mx_m\\)   
 * purequadratic(纯二次)：\\(y=\beta_0 +\beta_1x_1+...+\beta_mx_m+\sum_ {j=1}^m \beta_(jj)x_j^2\\)
 * interaction(交叉):\\(y=\beta_0 +\beta_1x_1+...+\beta_mx_m+ \sum _{1 \leq j\neq k \leq m} \beta_(jk)x_jx_k \\)
 * quadratic(完全二次):\\(y=\beta_0 +\beta_1x_1+...+\beta_mx_m+ \sum _{1 \leq j, k \leq m} \beta_(jk)x_jx_k\\)
 
 命令rstool产生一个交互式画面，画面中有m个图形，这m个图形分别给出了一个独立变量xi(另m-1个变量取固定值)与y的拟合曲线，以及y的置信区间.可以通过键入不同的xi的值来获得相应的y值.
 
 三、非线性回归
 
 非线性回归可用命令nlinfit,nlintool,nlpredci来实现.
 
 1. 回归：
 
 (1)确定回归系数的命令:\\([beta,r,J]=nlinfit(x,y,'model',beta0)\\)
 
 其中，输入数据x，y分别为n*m矩阵和n维列向量，对一元非线性回归，x为n维列向量；model是事先用M文件定义的非线性函数；beta0是回归系数的初值；beta是估计出的回归系数，r(残差)、J(Jacobian矩阵)是估计预测误差需要的数据.
 
 (2)非线性回归命令：nlintool(x,y,'model',beta0,alpha)
 
 其中各参数含义同前，alpha为显著性水平，缺省时为0.05.命令产生一个交互式的画面，画面中有拟合曲线和y的置信区间.通过左下方的Export下拉式菜单，可以输出回归系数等.
 
 2.预测和预测误差估计：
 
 \\([Y,DELTA]=nlpredci('model',x,beta,r,J)\\)
 
 求\\(nlinfit\\)或\\(nlintool\\)所得的回归函数在x处的预测值Y及预测值的显著性为95%的置信区间\\(Y\pm DELTA\\).
 
 某些非线性回归也可化为多元线性回归来解.
 
 四、逐步回归
 逐步回归的命令是stepwise，它提供了一个交互式画面，通过此工具可以自由地选择变量，进行统计分析.其通常用法是：\\(stepwise(x,y)\\)
 其中 x是自变量数据，y是因变量数据，分别为\\( n * m \\) 和\\( n*1 \\)矩阵.
 
###  9.2 聚类分析

#### 9.2.3 用MATLAB进行聚类

1. MATLAB中有关聚类分析的命令
 
1）pdist函数
 
 调用格式：\\(Y=pdist(X,'metric')\\) 

 说明：用‘metric’指定的方法计算X数据矩阵中对象之间的距离.X是一个\\(m*n\\)矩阵，它是由m个对象组成的数据集，每个对象的大小为n. metric取值如下：‘euclidean’，欧氏距离（默认）;‘seuclidean’，标准化欧氏距离;‘mahalanobis’，马氏距离；‘cityblock’，城市街区距离；‘minkowski’，闵可夫斯基距离；‘cosine’，余弦距离；‘correlation’，相关距离；‘hammimg’，汉明距离，‘jaccard’，杰卡德距离；‘chebyshev’，切比雪夫距离.
 
2）squareform函数

调用格式：\\(Z=squareform(Y,...)\\)

说明：强制将距离矩阵从上三角形式转化为方阵形式，或从方阵形式转化为上三角形式.

3）linkage函数

调用格式：\\(Z=linkage(Y,'method')\\)

说明：用‘method’参数指定的算法计算系统聚类树.Y是pdist函数返回的距离向量；method可取值如下：‘single’，最短距离法（默认）；‘complete’，最长距离法；‘average’，未加权平均距离法；‘weighted’，加权平均法；‘centroid’，质心距离法；‘median’，加权质心距离法；‘ward’，内平方距离法（最小方差算法）.返回Z为一个包含聚类树信息的(m-1)*3的矩阵.

4）dendrogram函数

调用格式：\\([H,T,...] = dendrogram(Z,p,...)\\)

说明：生成只有顶部p个节点的冰柱图（谱系图）.

5）cophenet函数

调用格式：\\(c=cophenet(Z,Y)\\)

说明：利用pdist函数生成的Y和linkage函数生成的Z计算cophenet相关系数.
  
6）cluster函数

调用格式：\\(T=cluster(Z,...)\\)

说明：根据linkage函数的输出Z创建分类















  
$\Gamma(n) = (n-1)!\quad\forall n\in\mathbb N$


When $\\( a \ne 0 )$, there are two solutions to $\\(ax^2 + bx + c = 0)$ and they are:
$$ x = {-b \pm \sqrt{b^2-4ac} \over 2a} $$

$$
\begin{aligned}
\dot{x} & = \sigma(y-x) \\
\dot{y} & = \rho x - y - xz \\
\dot{z} & = -\beta z + xy
\end{aligned}
$$

$$
J(\theta) = \frac 1 2 \sum_{i=1}^m (h_\theta(x^{(i)})-y^{(i)})^2
$$

 n<sup>2</sup>=n+1